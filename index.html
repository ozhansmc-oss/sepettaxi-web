<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport"
content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">

<title>SepetTaxi</title>
<meta name="theme-color" content="#000000">

<link rel="manifest" href="manifest.json">

<link rel="stylesheet"
href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="config.js"></script>
<script src="log.js"></script>

<style>
*{box-sizing:border-box}
html,body{
margin:0;height:100%;
font-family:Arial,Helvetica,sans-serif;
background:#000;color:#fff;overflow:hidden
}
:root{
--y:#f5c400;
--panel:#0f0f0f;
--line:#222;
}

/* MAP */
#map{
position:fixed;
inset:0;
z-index:1;
}

/* TOP OVERLAYS */
.topbar{
position:fixed;
top:env(safe-area-inset-top,10px);
left:0;right:0;
display:flex;
justify-content:space-between;
padding:10px;
z-index:1000;
pointer-events:none;
}
.topbar > *{pointer-events:auto}

.iconBtn{
width:44px;height:44px;
border-radius:14px;
background:#000;
border:1px solid var(--line);
display:flex;
align-items:center;
justify-content:center;
font-size:20px;
}

/* DRIVER MINI */
#driverMini{
background:var(--panel);
padding:6px 12px;
border-radius:14px;
border:1px solid var(--line);
font-size:13px;
}

/* NOTIFY */
#notify{
position:relative;
}
#badge{
position:absolute;
top:6px;right:6px;
width:8px;height:8px;
background:red;border-radius:50%;
}

/* DRAWER */
#drawer{
position:fixed;
top:0;right:-280px;
width:280px;height:100%;
background:#000;
border-left:1px solid var(--line);
z-index:1200;
padding:20px;
transition:.25s;
}
#drawer.open{right:0}
#drawer a{
display:block;
padding:14px 0;
border-bottom:1px solid var(--line);
color:#fff;text-decoration:none;
}

/* BOTTOM SHEET */
#sheet{
position:fixed;
left:0;right:0;bottom:0;
height:42%;
background:var(--panel);
border-top:1px solid var(--line);
border-radius:20px 20px 0 0;
padding:14px;
z-index:900;
display:flex;
flex-direction:column;
gap:12px;
}

/* CARDS */
.cards{display:flex;gap:10px}
.card{
flex:1;
border:1px solid var(--line);
border-radius:16px;
padding:14px;
text-align:center;
font-weight:900;
background:#000;
}
.card.active{
border-color:var(--y);
color:var(--y);
}

/* INFO */
#info{
display:flex;
justify-content:space-between;
padding:10px;
border:1px solid var(--line);
border-radius:14px;
}

/* CTA */
#cta{
padding:16px;
background:var(--y);
color:#000;
border-radius:18px;
text-align:center;
font-weight:900;
}

/* VEHICLE ICONS */
.taxiIcon,.motoIcon{
width:32px;height:32px;
display:flex;
align-items:center;
justify-content:center;
font-size:18px;
border-radius:50%;
}
.taxiIcon{background:#f5c400;color:#000}
.motoIcon{background:#fff;color:#000}
</style>
</head>

<body>

<div id="map"></div>

<div class="topbar">
  <div id="driverMini" onclick="location.href='driver-register.html'">
    üöó S√ºr√ºc√º Ol
  </div>

  <div style="display:flex;gap:10px">
    <div id="notify" class="iconBtn">üîî<div id="badge"></div></div>
    <div id="hamburger" class="iconBtn">‚ò∞</div>
  </div>
</div>

<div id="drawer">
  <a href="#">Hesabƒ±m</a>
  <a href="#">√ñnceki Hizmetler</a>
  <a href="driver-register.html">S√ºr√ºc√º Ol</a>
  <a href="driver.html">S√ºr√ºc√º Giri≈üi</a>
  <a href="#">Destek</a>
  <a href="#">Ayarlar / KVKK</a>
</div>

<div id="sheet">
  <div class="cards">
    <div id="taxiCard" class="card active">üöï Taksi</div>
    <div id="courierCard" class="card">üèç Kurye</div>
  </div>

  <div id="info">
    <div>Mesafe: <b id="km">‚Äî</b></div>
    <div>√úcret: <b id="price">‚Äî</b></div>
  </div>

  <div id="cta">Taksi √áaƒüƒ±r</div>
</div>

<script>
/* DRAWER */
hamburger.onclick=()=>drawer.classList.toggle("open");

/* MAP */
const map=L.map("map",{zoomControl:false});
L.tileLayer(
"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",
{maxZoom:19}
).addTo(map);

/* LOCATION ‚Äì USER ACTION */
map.on("click",()=>{
navigator.geolocation.getCurrentPosition(p=>{
const lat=p.coords.latitude,lng=p.coords.longitude;
map.setView([lat,lng],15);
spawnVehicles(lat,lng);
},{
enableHighAccuracy:true
});
});

/* VEHICLES */
function spawnVehicles(lat,lng){
for(let i=0;i<3;i++){
L.marker(
[lat+(Math.random()-.5)/200,lng+(Math.random()-.5)/200],
{icon:L.divIcon({className:"taxiIcon",html:"üöï"})}
).addTo(map);

L.marker(
[lat+(Math.random()-.5)/200,lng+(Math.random()-.5)/200],
{icon:L.divIcon({className:"motoIcon",html:"üèç"})}
).addTo(map);
}
}

/* CARD TOGGLE */
taxiCard.onclick=()=>{
taxiCard.classList.add("active");
courierCard.classList.remove("active");
cta.textContent="Taksi √áaƒüƒ±r";
};
courierCard.onclick=()=>{
location.href="courier.html";
};

/* PWA */
if("serviceWorker"in navigator){
navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
