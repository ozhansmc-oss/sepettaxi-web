<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>SepetTaxi</title>
<meta name="theme-color" content="#f5c400" />

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  *{box-sizing:border-box}
  :root{
    --y:#f5c400;
    --bg:#050506;
    --panel:#0f0f10;
    --card:#141416;
    --line:rgba(255,255,255,.12);
    --mut:rgba(255,255,255,.65);
    --mut2:rgba(255,255,255,.42);
    --ok:#32d74b;
    --bad:#ff5a5f;
    --shadow:0 18px 60px rgba(0,0,0,.55);
    --r:18px;
  }
  html,body{margin:0;height:100%;background:var(--bg);color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial}
  a{color:inherit;text-decoration:none}
  button,input{font-family:inherit}

  /* ===== GLOBAL TOPBAR (tek) ===== */
  #topbar{
    position:fixed;left:0;right:0;top:0;z-index:1500;
    height:56px;display:flex;align-items:center;justify-content:space-between;
    padding:0 14px;
    pointer-events:none;
    background:linear-gradient(to bottom,rgba(0,0,0,.70),rgba(0,0,0,0));
  }
  #topbar .btn{
    pointer-events:auto;
    width:44px;height:44px;border-radius:14px;
    background:rgba(15,15,16,.76);
    border:1px solid rgba(255,255,255,.10);
    display:flex;align-items:center;justify-content:center;
    box-shadow:0 10px 26px rgba(0,0,0,.45);
    user-select:none;
  }
  #topbar .brand{
    pointer-events:none;
    display:flex;align-items:center;gap:10px;
    font-weight:900;letter-spacing:.2px;
  }
  #topbar .mark{
    width:28px;height:28px;border-radius:9px;background:var(--y);color:#000;
    display:flex;align-items:center;justify-content:center;
    font-weight:1000;
  }
  #topbar .sub{
    display:block;font-size:11px;color:var(--mut2);font-weight:700;margin-top:2px;
  }

  /* ===== MAP: %50 ===== */
  #map-wrap{height:50vh;position:relative;background:#000}
  #map{height:100%;width:100%}
  .leaflet-control-zoom{display:none !important;} /* + - gizle (kilitli) */

  /* ===== BOTTOM SHEET: kontrol ===== */
  #bottom{
    position:fixed;left:0;right:0;bottom:0;z-index:1000;
    height:50vh;
    background:var(--panel);
    border-radius:18px 18px 0 0;
    box-shadow:var(--shadow);
    border-top:1px solid rgba(255,255,255,.08);
    padding:14px 14px 18px;
    overflow:auto;
  }

  .card{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:var(--r);
    padding:14px;
    margin-bottom:12px;
  }

  .h1{font-size:18px;font-weight:950;margin:0 0 6px}
  .p{font-size:12.5px;color:var(--mut);margin:0}
  .row{display:flex;gap:10px}
  .col{flex:1}

  .chip{
    display:inline-flex;align-items:center;gap:8px;
    border:1px solid var(--line);
    border-radius:999px;
    padding:8px 10px;
    color:#fff;
    background:rgba(255,255,255,.03);
    font-weight:800;
    font-size:12px;
    user-select:none;
  }
  .chip.on{border-color:rgba(245,196,0,.55);box-shadow:0 0 0 2px rgba(245,196,0,.12) inset}
  .chip small{color:var(--mut2);font-weight:700}

  .field{
    width:100%;
    padding:12px 12px;
    border-radius:14px;
    border:1px solid rgba(255,255,255,.10);
    background:#0b0b0c;
    color:#fff;
    outline:none;
  }
  .field:focus{border-color:rgba(245,196,0,.55);box-shadow:0 0 0 3px rgba(245,196,0,.12)}
  .hint{font-size:12px;color:var(--mut2);margin-top:8px}

  .btnMain{
    width:100%;
    padding:14px 14px;
    border-radius:16px;
    border:none;
    background:var(--y);
    color:#000;
    font-weight:1000;
    font-size:15px;
  }
  .btnMain:disabled{opacity:.38}
  .btnGhost{
    width:100%;
    padding:12px 14px;
    border-radius:16px;
    border:1px solid rgba(255,255,255,.12);
    background:transparent;
    color:#fff;
    font-weight:900;
  }

  .split{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    margin-top:10px;
    font-size:12.5px;
    color:var(--mut);
  }
  .split b{color:#fff}

  /* ===== DRAWER MENU ===== */
  #drawerBackdrop{
    position:fixed;inset:0;z-index:1900;
    background:rgba(0,0,0,.55);
    backdrop-filter:blur(6px);
    display:none;
  }
  #drawer{
    position:fixed;top:0;left:0;bottom:0;z-index:2000;
    width:min(86vw,360px);
    background:#0b0b0c;
    border-right:1px solid rgba(255,255,255,.10);
    transform:translateX(-105%);
    transition:transform .18s ease;
    padding:14px;
  }
  #drawer.open{transform:translateX(0)}
  #drawerBackdrop.show{display:block}
  .dHead{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  .dTitle{font-weight:1000}
  .dItem{
    display:flex;align-items:center;justify-content:space-between;
    padding:12px 12px;border-radius:14px;
    border:1px solid rgba(255,255,255,.10);
    background:rgba(255,255,255,.03);
    margin-top:10px;
  }
  .dItem small{display:block;color:var(--mut2);font-weight:700;margin-top:2px}
  .dItem b{font-weight:950}
  .dClose{
    width:40px;height:40px;border-radius:14px;
    border:1px solid rgba(255,255,255,.10);
    background:rgba(255,255,255,.03);
    color:#fff;font-weight:1000;
  }

  /* ===== MODALS (overlay) ===== */
  .overlay{
    position:fixed;inset:0;z-index:2500;
    background:rgba(0,0,0,.62);
    backdrop-filter:blur(6px);
    display:none;
    align-items:center;
    justify-content:center;
    padding:16px;
  }
  .overlay.show{display:flex}
  .modal{
    width:min(92vw,520px);
    background:#0b0b0c;
    border:1px solid rgba(255,255,255,.12);
    border-radius:20px;
    box-shadow:var(--shadow);
    overflow:hidden;
  }
  .mTop{
    padding:14px 14px;
    border-bottom:1px solid rgba(255,255,255,.10);
    display:flex;align-items:center;justify-content:space-between;
  }
  .mTop b{font-weight:1000}
  .mBody{padding:14px}
  .mRow{display:flex;gap:10px;margin-top:10px}
  .mRow .col{flex:1}
  .mActions{display:flex;gap:10px;margin-top:12px}
  .mActions button{flex:1}

  /* ===== STATUS / SEARCHING ===== */
  #searchingBadge{
    position:fixed;left:50%;top:66px;transform:translateX(-50%);
    z-index:1600;
    background:rgba(15,15,16,.82);
    border:1px solid rgba(255,255,255,.12);
    border-radius:999px;
    padding:8px 12px;
    display:none;
    color:#fff;
    font-size:12px;
    gap:10px;
    align-items:center;
  }
  #searchingBadge.show{display:flex}
  .dot{
    width:8px;height:8px;border-radius:99px;background:var(--y);
    animation:pulse 1s infinite;
  }
  @keyframes pulse{
    0%{transform:scale(1);opacity:.6}
    50%{transform:scale(1.25);opacity:1}
    100%{transform:scale(1);opacity:.6}
  }

  /* small helper */
  .mut{color:var(--mut)}
  .mut2{color:var(--mut2)}
</style>
</head>

<body>

<!-- TOPBAR (tek) -->
<header id="topbar">
  <div class="btn" id="hambBtn" aria-label="Men√º">‚ò∞</div>
  <div class="brand" aria-hidden="true">
    <div class="mark">S</div>
    <div>
      SepetTaxi
      <span class="sub" id="topStatus">Konum alƒ±nƒ±yor‚Ä¶</span>
    </div>
  </div>
  <div style="width:44px;height:44px"></div>
</header>

<div id="searchingBadge"><span class="dot"></span> S√ºr√ºc√º aranƒ±yor‚Ä¶</div>

<!-- MAP -->
<div id="map-wrap"><div id="map"></div></div>

<!-- BOTTOM SHEET -->
<section id="bottom">

  <div class="card" id="heroCard">
    <div class="h1">Hizmet Se√ß</div>
    <p class="p">Taksi veya kurye se√ß, adresleri belirle ve √ßaƒürƒ±yƒ± ba≈ülat.</p>

    <div class="row" style="margin-top:12px">
      <div class="col">
        <div class="chip on" id="chipTaxi" role="button" tabindex="0">
          üöï <span>Taksi</span> <small>≈ûehir i√ßi</small>
        </div>
      </div>
      <div class="col">
        <div class="chip" id="chipCourier" role="button" tabindex="0">
          üèçÔ∏è <span>Kurye</span> <small>Paket</small>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="h1" style="margin-bottom:10px">Adres</div>

    <input class="field" id="fromInput" placeholder="Nereden (alƒ±nacak konum)" readonly>
    <div class="hint">Dokun ‚Üí adres se√ß</div>

    <div style="height:10px"></div>

    <input class="field" id="toInput" placeholder="Nereye (teslim / varƒ±≈ü)" readonly>
    <div class="hint">Dokun ‚Üí adres se√ß</div>

    <div class="split">
      <span>Mesafe</span><b id="distText">‚Äî</b>
    </div>
    <div class="split">
      <span>Tahmini √úcret</span><b id="priceText">‚Äî</b>
    </div>
    <div class="hint mut2" id="priceHint">Mesafe ve √ºcret, iki adres se√ßilince hesaplanƒ±r.</div>
  </div>

  <button class="btnMain" id="callBtn" disabled>√áaƒüƒ±r</button>

  <div class="card">
    <div class="row" style="align-items:center;justify-content:space-between">
      <div>
        <div style="font-weight:1000">S√ºr√ºc√º m√ºs√ºn?</div>
        <div class="mut2" style="font-size:12px;margin-top:3px">Kazancƒ±nƒ± g√∂r, i≈üi havuzdan kabul et.</div>
      </div>
      <a class="btnGhost" href="./driver.html" style="max-width:140px;text-align:center;display:inline-block">S√ºr√ºc√º Ol</a>
    </div>
  </div>

</section>

<!-- Drawer -->
<div id="drawerBackdrop"></div>
<aside id="drawer" aria-hidden="true">
  <div class="dHead">
    <div class="dTitle">Men√º</div>
    <button class="dClose" id="drawerClose">‚úï</button>
  </div>

  <a class="dItem" href="./driver.html">
    <div>
      <b>S√ºr√ºc√º Giri≈üi</b>
      <small>S√ºr√ºc√º paneline ge√ß</small>
    </div>
    <div>‚Ä∫</div>
  </a>

  <a class="dItem" href="./driver.html">
    <div>
      <b>S√ºr√ºc√º Ol</b>
      <small>Ba≈üvuru / kayƒ±t sayfasƒ±</small>
    </div>
    <div>‚Ä∫</div>
  </a>

  <a class="dItem" id="supportLink" href="#" onclick="return false;">
    <div>
      <b>Destek</b>
      <small>WhatsApp √ºzerinden destek</small>
    </div>
    <div>‚Ä∫</div>
  </a>

  <div class="mut2" style="font-size:12px;margin-top:12px">
    Not: Admin giri≈üi men√ºde yok (kilitli karar).
  </div>
</aside>

<!-- Address Modal -->
<div class="overlay" id="addrOverlay">
  <div class="modal">
    <div class="mTop">
      <b>Adres Se√ß</b>
      <button class="dClose" id="addrClose">‚úï</button>
    </div>
    <div class="mBody">
      <input class="field" id="addrQuery" placeholder="Arama (√∂rn: Nil√ºfer, Bursa)">
      <div class="mActions">
        <button class="btnGhost" id="nearBtn">Yakƒ±nƒ±mdan Ara</button>
        <button class="btnMain" id="searchBtn">Ara</button>
      </div>
      <div id="addrResults" style="margin-top:12px"></div>
      <div class="mut2" id="addrEmpty" style="font-size:12px;margin-top:10px;display:none">Adres bulunamadƒ±.</div>
    </div>
  </div>
</div>

<!-- Register Modal -->
<div class="overlay" id="regOverlay">
  <div class="modal">
    <div class="mTop">
      <b>Zorunlu Kayƒ±t</b>
      <button class="dClose" id="regClose">‚úï</button>
    </div>
    <div class="mBody">
      <div class="mut2" style="font-size:12px">
        Bilgiler √ßaƒürƒ± i≈ülemi i√ßin zorunludur. Sonradan d√ºzenleyebilirsiniz.
      </div>
      <div class="mRow">
        <div class="col"><input class="field" id="firstName" placeholder="Ad"></div>
        <div class="col"><input class="field" id="lastName" placeholder="Soyad"></div>
      </div>
      <div class="mRow">
        <div class="col"><input class="field" id="phone" placeholder="Telefon (05xx...)" inputmode="tel"></div>
      </div>
      <div class="mut2" id="regErr" style="font-size:12px;margin-top:10px;display:none;color:var(--bad)">
        L√ºtfen t√ºm alanlarƒ± doƒüru girin.
      </div>
      <div class="mActions">
        <button class="btnGhost" id="regCancel">Vazge√ß</button>
        <button class="btnMain" id="regSave">Kaydet</button>
      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   CONFIG (senin verdiƒüin)
========================= */
const API = "https://script.google.com/macros/s/AKfycbwXKzBcvA5xRpvGqJSWCq7vzrOGxG1KplHq1vCHTb4j5auQ1G0ySNSfn9der1um4MsMug/exec";

/* WhatsApp destek */
const SUPPORT_WHATSAPP = "https://wa.me/90XXXXXXXXXX?text=" + encodeURIComponent("Merhaba SepetTaxi destek: ");

/* =========================
   STATE
========================= */
let serviceType = "taxi";
let me = { lat:null, lng:null };
let from = { addr:"", lat:null, lng:null };
let to   = { addr:"", lat:null, lng:null };
let picking = "from";
let map, meMarker, fromMarker, toMarker, line;

/* =========================
   HELPERS
========================= */
const $ = (id)=>document.getElementById(id);

function fmtKm(km){
  if(!isFinite(km)) return "‚Äî";
  return (Math.round(km*10)/10).toFixed(1) + " km";
}
function fmtTL(v){
  if(!isFinite(v)) return "‚Äî";
  return Math.round(v) + " ‚Ç∫";
}
function haversineKm(a,b,c,d){
  const R=6371, toRad=(x)=>x*Math.PI/180;
  const dLat=toRad(c-a), dLng=toRad(d-b);
  const s1=Math.sin(dLat/2), s2=Math.sin(dLng/2);
  const q=s1*s1 + Math.cos(toRad(a))*Math.cos(toRad(c))*s2*s2;
  return 2*R*Math.asin(Math.min(1,Math.sqrt(q)));
}
function estimatePrice(st, km){
  // MVP: sade, stabil
  if(!isFinite(km)) return NaN;
  if(st==="courier"){
    const base=80, perKm=12; // kurye
    return base + km*perKm;
  }
  const base=70, perKm=14; // taksi
  return base + km*perKm;
}
function setService(st){
  serviceType = st;
  $("chipTaxi").classList.toggle("on", st==="taxi");
  $("chipCourier").classList.toggle("on", st==="courier");
  $("callBtn").textContent = (st==="courier") ? "Kurye √áaƒüƒ±r" : "Taksi √áaƒüƒ±r";
  updateCalc();
}
function show(el){ el.classList.add("show"); }
function hide(el){ el.classList.remove("show"); }
function toastTopStatus(t){ $("topStatus").textContent = t; }

function canCall(){
  return !!(serviceType && from.lat!=null && to.lat!=null);
}
function updateCalc(){
  const ok = canCall();
  $("callBtn").disabled = !ok;

  if(!ok){
    $("distText").textContent="‚Äî";
    $("priceText").textContent="‚Äî";
    return;
  }
  const km = haversineKm(from.lat, from.lng, to.lat, to.lng);
  const price = estimatePrice(serviceType, km);
  $("distText").textContent = fmtKm(km);
  $("priceText").textContent = fmtTL(price);

  // route line
  if(line){ map.removeLayer(line); line=null; }
  line = L.polyline([[from.lat,from.lng],[to.lat,to.lng]], {weight:4, opacity:0.7}).addTo(map);
  map.fitBounds(line.getBounds(), {padding:[30,30]});
}

/* =========================
   MAP INIT (50vh)
========================= */
function initMap(){
  map = L.map("map",{ zoomControl:false, attributionControl:false }).setView([40.195,29.060], 13);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", { maxZoom: 19 }).addTo(map);

  // ƒ∞lk a√ßƒ±lƒ±≈üta harita pasif (tedirginliƒüi azaltƒ±r)
  map.dragging.disable();
  map.scrollWheelZoom.disable();
  map.doubleClickZoom.disable();
  map.touchZoom.disable();

  meMarker = L.marker([40.195,29.060]).addTo(map);
}

/* Haritayƒ± adres se√ßimi sonrasƒ± canlandƒ±r */
function enableMap(){
  map.dragging.enable();
  map.scrollWheelZoom.enable();
  map.doubleClickZoom.enable();
  map.touchZoom.enable();
}

/* =========================
   GEOLOCATION
========================= */
function getLocation(){
  toastTopStatus("Konum alƒ±nƒ±yor‚Ä¶");
  if(!navigator.geolocation){
    toastTopStatus("Konum desteklenmiyor");
    return;
  }
  navigator.geolocation.getCurrentPosition(
    (pos)=>{
      me.lat = pos.coords.latitude;
      me.lng = pos.coords.longitude;
      meMarker.setLatLng([me.lat, me.lng]);
      map.setView([me.lat, me.lng], 15);
      toastTopStatus("Konum hazƒ±r");
    },
    ()=>{
      toastTopStatus("Konum izni yok");
    },
    { enableHighAccuracy:true, timeout:8000, maximumAge:60000 }
  );
}

/* =========================
   DRAWER
========================= */
function openDrawer(){
  $("drawerBackdrop").classList.add("show");
  $("drawer").classList.add("open");
}
function closeDrawer(){
  $("drawerBackdrop").classList.remove("show");
  $("drawer").classList.remove("open");
}

/* =========================
   ADDRESS SEARCH (Nominatim)
========================= */
async function nominatimSearch(q, near){
  const base = "https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&limit=8&q=" + encodeURIComponent(q);
  const url = (near && me.lat!=null) ? (base + "&viewbox=" +
    [me.lng-0.15, me.lat+0.15, me.lng+0.15, me.lat-0.15].join(",") + "&bounded=1") : base;

  const r = await fetch(url, { headers:{ "Accept":"application/json" }});
  return await r.json();
}
function renderAddrResults(list){
  const box = $("addrResults");
  box.innerHTML = "";
  $("addrEmpty").style.display = (list.length ? "none" : "block");

  list.forEach((it)=>{
    const d = document.createElement("div");
    d.className = "dItem";
    d.style.cursor = "pointer";
    d.innerHTML = `
      <div style="max-width:78%">
        <b>${it.display_name.split(",").slice(0,2).join(",")}</b>
        <small>${it.display_name}</small>
      </div>
      <div>‚Ä∫</div>
    `;
    d.onclick = ()=> pickAddress(it.display_name, parseFloat(it.lat), parseFloat(it.lon));
    box.appendChild(d);
  });
}
function openAddrPicker(which){
  picking = which;
  $("addrQuery").value = "";
  $("addrResults").innerHTML = "";
  $("addrEmpty").style.display="none";
  show($("addrOverlay"));
}
function pickAddress(addr, lat, lng){
  if(picking==="from"){
    from.addr = addr; from.lat = lat; from.lng = lng;
    $("fromInput").value = addr;
    if(fromMarker) map.removeLayer(fromMarker);
    fromMarker = L.marker([lat,lng]).addTo(map);
  }else{
    to.addr = addr; to.lat = lat; to.lng = lng;
    $("toInput").value = addr;
    if(toMarker) map.removeLayer(toMarker);
    toMarker = L.marker([lat,lng]).addTo(map);
  }

  enableMap();
  updateCalc();
  hide($("addrOverlay"));
}

/* =========================
   REGISTER (Zorunlu)
========================= */
function loadUser(){
  try{
    const u = JSON.parse(localStorage.getItem("sepettaxi_user")||"null");
    return u && u.first && u.last && u.phone ? u : null;
  }catch(e){ return null; }
}
function saveUser(u){
  localStorage.setItem("sepettaxi_user", JSON.stringify(u));
}
function openRegister(){
  $("regErr").style.display="none";
  const u = loadUser();
  $("firstName").value = u?.first || "";
  $("lastName").value  = u?.last  || "";
  $("phone").value     = u?.phone || "";
  show($("regOverlay"));
}
function validPhone(p){
  // basit TR kontrol (MVP)
  const x = (p||"").replace(/\s/g,"");
  return x.length>=10;
}

/* =========================
   BACKEND CALLS
========================= */
async function apiCall(action, payload){
  const body = JSON.stringify({ action, ...payload });
  const r = await fetch(API, {
    method:"POST",
    headers:{ "Content-Type":"text/plain;charset=utf-8" },
    body
  });
  const data = await r.json();
  if(data && data.error) throw new Error(data.error);
  return data;
}

function showSearching(on){
  $("searchingBadge").classList.toggle("show", !!on);
}

async function createJob(){
  const u = loadUser();
  if(!u){ openRegister(); return; }

  if(!canCall()){
    alert("L√ºtfen nereden ve nereye se√ßin.");
    return;
  }

  const km = haversineKm(from.lat, from.lng, to.lat, to.lng);
  const price = estimatePrice(serviceType, km);

  showSearching(true);

  try{
    const res = await apiCall("createJob", {
      service_type: serviceType,
      customer_first: u.first,
      customer_last: u.last,
      customer_phone: u.phone,
      from_address: from.addr,
      to_address: to.addr,
      pickup_lat: from.lat,
      pickup_lng: from.lng,
      dropoff_lat: to.lat,
      dropoff_lng: to.lng,
      distance_km: km,
      price: price
    });

    // beklenen: { ok:true, job_id:"..." } veya benzeri
    const jobId = res.job_id || res.id || res.jobId;
    if(!jobId) throw new Error("job_id alƒ±namadƒ±");

    // Track parametre adƒ± farklƒ±ysa burada deƒüi≈ütir:
    window.location.href = "./track.html?job_id=" + encodeURIComponent(jobId);

  }catch(e){
    showSearching(false);
    alert("Hata: " + (e?.message || e));
  }
}

/* =========================
   EVENTS
========================= */
window.addEventListener("load", ()=>{
  initMap();
  getLocation();
  setService("taxi");

  // service chips
  $("chipTaxi").onclick = ()=>setService("taxi");
  $("chipCourier").onclick = ()=>setService("courier");

  // inputs -> open picker
  $("fromInput").addEventListener("click", ()=>openAddrPicker("from"));
  $("toInput").addEventListener("click", ()=>openAddrPicker("to"));

  // call
  $("callBtn").addEventListener("click", ()=>createJob());

  // drawer
  $("hambBtn").addEventListener("click", openDrawer);
  $("drawerBackdrop").addEventListener("click", closeDrawer);
  $("drawerClose").addEventListener("click", closeDrawer);

  // support
  $("supportLink").addEventListener("click", ()=>{
    window.open(SUPPORT_WHATSAPP, "_blank");
  });

  // address modal
  $("addrClose").addEventListener("click", ()=>hide($("addrOverlay")));
  $("searchBtn").addEventListener("click", async ()=>{
    const q = $("addrQuery").value.trim();
    if(!q) return;
    const list = await nominatimSearch(q, false);
    renderAddrResults(list);
  });
  $("nearBtn").addEventListener("click", async ()=>{
    const q = $("addrQuery").value.trim() || "yakƒ±nƒ±m";
    const list = await nominatimSearch(q==="yakƒ±nƒ±m" ? "bursa" : q, true);
    renderAddrResults(list);
  });

  // register modal
  $("regClose").addEventListener("click", ()=>hide($("regOverlay")));
  $("regCancel").addEventListener("click", ()=>{
    hide($("regOverlay"));
  });
  $("regSave").addEventListener("click", ()=>{
    const first = $("firstName").value.trim();
    const last  = $("lastName").value.trim();
    const phone = $("phone").value.trim();
    if(!first || !last || !validPhone(phone)){
      $("regErr").style.display="block";
      return;
    }
    saveUser({ first, last, phone });
    hide($("regOverlay"));
    // kayƒ±t bitti, √ßaƒürƒ± tekrar denensin diye:
    createJob();
  });
});
</script>

</body>
</html>
