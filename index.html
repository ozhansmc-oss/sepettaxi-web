<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SepetTaxi</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
html,body{margin:0;height:100%;font-family:system-ui;background:#0b1220;color:#fff}
.hidden{display:none}
button{cursor:pointer;border-radius:10px;border:0;padding:12px 16px;font-weight:700}
.primary{background:#3b82f6;color:#fff}
.panel{background:#111827;border-radius:14px;padding:14px}
.topbar{position:absolute;top:10px;left:10px;right:10px;z-index:1000;display:flex;justify-content:space-between;background:#111827cc;padding:10px;border-radius:12px}
.bottom{position:absolute;bottom:0;left:0;right:0;z-index:1000;padding:10px}
.cards{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.card{background:#1f2937;padding:12px;border-radius:12px}
#map{height:100%;width:100%}
</style>
</head>

<body>

<!-- STATE: LANDING -->
<section id="landing">
  <div style="display:flex;height:100%;align-items:center;justify-content:center">
    <div class="panel">
      <h2>SepetTaxi</h2>
      <p>Taksi Â· Kurye Â· HavalimanÄ± Transferi</p>
      <button class="primary" onclick="goApp()">Devam Et</button>
    </div>
  </div>
</section>

<!-- STATE: APP -->
<section id="app" class="hidden">
  <div id="map"></div>

  <div class="topbar">
    <b>SepetTaxi</b>
    <span id="userState">Misafir</span>
  </div>

  <div class="bottom">
    <div class="panel" id="servicePanel">
      <b>Hizmet SeÃ§</b>
      <div class="cards">
        <div class="card" onclick="selectService('taxi')">ğŸš• Taksi</div>
        <div class="card" onclick="selectService('courier')">ğŸ›µ Kurye</div>
        <div class="card" onclick="selectService('transfer')">âœˆï¸ Transfer</div>
      </div>
    </div>

    <div class="panel hidden" id="taxiPanel">
      <div>
        <label>Nereden</label>
        <input id="from" style="width:100%">
      </div>
      <div>
        <label>Nereye</label>
        <input id="to" style="width:100%">
      </div>
      <button class="primary" onclick="callTaxi()">Taksi Ã‡aÄŸÄ±r</button>
    </div>
  </div>
</section>

<script>
/* CONFIG */
const API_URL = "https://script.google.com/macros/s/AKfycbxGK3XXKVX-65ZfRCtGhMdIoOgV6RAx7tSldcBW3ugRzB7_T3Bv2DLsCazrpLgYPwg0/exec"; // /exec URL BURAYA

/* STATE */
let map, meMarker;
let state = "LANDING";

/* STATE CONTROL */
function setState(s){
  state = s;
  landing.classList.toggle("hidden", s!=="LANDING");
  app.classList.toggle("hidden", s!=="APP");
}

/* LANDING â†’ APP */
function goApp(){
  setState("APP");
  initMap();
}

/* MAP */
function initMap(){
  if(map) return;
  map = L.map("map").setView([40.195,29.06],13);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
  locate();
}

function locate(){
  navigator.geolocation.getCurrentPosition(pos=>{
    const {latitude,longitude}=pos.coords;
    meMarker = L.marker([latitude,longitude]).addTo(map);
    map.setView([latitude,longitude],16);
    document.getElementById("from").value = "Mevcut Konum";
  });
}

/* SERVICE */
function selectService(svc){
  if(svc!=="taxi"){
    alert("Bu akÄ±ÅŸ daha sonra baÄŸlanacak");
    return;
  }
  servicePanel.classList.add("hidden");
  taxiPanel.classList.remove("hidden");
}

/* CALL */
function callTaxi(){
  alert("Taksi Ã§aÄŸrÄ±ldÄ± (demo)");
  // burada createJob â†’ FAZ 3 yÃ¶nlendirme baÄŸlanacak
}

/* INIT */
setState("LANDING");
</script>

</body>
</html>
