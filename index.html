<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>SepetTaxi</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<style>
body{margin:0;font-family:Arial;background:#f6f7f9}
.hidden{display:none}
.section{padding:20px}
.banner{background:#0f172a;color:#fff;padding:30px}
.cards{display:flex;gap:12px}
.card{flex:1;background:#fff;padding:20px;border-radius:10px;text-align:center;cursor:pointer}
input,button{width:100%;padding:12px;margin-top:10px}
#map{height:300px;margin-top:10px}
</style>
</head>
<body>

<!-- BANNER -->
<div class="banner">
  <h1>Taksi, Kurye ve Transfer â€“ Tek Platform</h1>
  <p>Åeffaf fiyat Â· CanlÄ± takip Â· Kolay kullanÄ±m</p>
  <button onclick="showServices()">Hizmet SeÃ§</button>
</div>

<!-- SERVICE SELECT -->
<div id="services" class="section hidden">
  <div class="cards">
    <div class="card" onclick="selectService('taksi')">ğŸš• Taksi</div>
    <div class="card" onclick="selectService('kurye')">ğŸ“¦ Kurye</div>
    <div class="card" onclick="selectService('transfer')">âœˆï¸ Transfer</div>
  </div>
</div>

<!-- REGISTER -->
<div id="register" class="section hidden">
  <h3>KayÄ±t</h3>
  <input id="name" placeholder="Ad Soyad"/>
  <input id="phone" placeholder="05XXXXXXXXX" maxlength="11"/>
  <button onclick="saveUser()">Devam Et</button>
</div>

<!-- MAP -->
<div id="location" class="section hidden">
  <h3>Konum SeÃ§imi</h3>
  <div id="map"></div>
  <button onclick="createJob()">Ã‡aÄŸrÄ± OluÅŸtur</button>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
const API_URL = "https://script.google.com/macros/s/AKfycbw1SadnUf_xpMIGin9w1k4qot6-wql9mdE1wCwPsKK87m1x3DkZhmlY9YbntbjusRT_/exec";
let service=null,user={},pickup={};

function showServices(){services.classList.remove("hidden")}
function selectService(s){service=s;services.classList.add("hidden");register.classList.remove("hidden")}
function saveUser(){
  user.name=name.value.trim();
  user.phone=phone.value.trim();
  if(user.name.length<3||user.phone.length!==11)return alert("Bilgiler eksik");
  register.classList.add("hidden");
  location.classList.remove("hidden");
  initMap();
}
let map;
function initMap(){
 map=L.map('map').setView([40.195,29.060],13);
 L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
 map.on('click',e=>pickup=e.latlng);
}
function createJob(){
 if(!pickup)return alert("Konum seÃ§");
 fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({
    action:"createJob",
    service_type:service,
    user_name:user.name,
    user_phone:user.phone,
    pickup_lat:pickup.lat,
    pickup_lng:pickup.lng
  })
 });
 alert("Talep alÄ±ndÄ±");
}
</script>
</body>
</html>
