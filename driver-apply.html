<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SepetTaxi – Sürücü Başvurusu</title>
<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#0f0f0f;color:#fff}
header{height:56px;background:#000;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:bold}
header span{color:#f5c400}
.container{padding:16px;max-width:520px;margin:auto}
.card{background:#1b1b1b;border-radius:14px;padding:16px;margin-top:14px}
.label{font-size:12px;color:#aaa;margin-top:10px}
input,select,button{width:100%;padding:12px;border-radius:10px;border:none;margin-top:6px}
input,select{background:#0f0f0f;color:#fff;border:1px solid #333}
button{background:#f5c400;color:#000;font-weight:bold;cursor:pointer;margin-top:14px}
.small{font-size:12px;color:#aaa;line-height:1.35;margin-top:10px}
.notice{margin-top:12px;padding:12px;border-radius:12px;background:#111;border:1px solid #2a2a2a;color:#ddd;display:none}
.notice.ok{border-color:#2ecc71}
.notice.bad{border-color:#e74c3c}
.row{display:flex;gap:10px;flex-wrap:wrap}
.row .col{flex:1;min-width:140px}
a{color:#f5c400;text-decoration:none}
</style>
</head>

<body>
<header>Sepet<span>Taxi</span> Sürücü Başvurusu</header>

<div class="container">
  <div class="card">
    <div class="small">
      Bu sayfa sürücü aday başvurusu içindir.
      Başvurunuz admin onay sürecine girer.
      Onay sonrası sürücü paneli bilgileri paylaşılır.
    </div>

    <div class="row">
      <div class="col">
        <div class="label">Ad</div>
        <input id="firstName" placeholder="Örn: Ahmet">
      </div>
      <div class="col">
        <div class="label">Soyad</div>
        <input id="lastName" placeholder="Örn: Yılmaz">
      </div>
    </div>

    <div class="label">Telefon</div>
    <input id="phone" placeholder="05xxxxxxxxx" inputmode="tel">

    <div class="label">Araç Tipi</div>
    <select id="vehicleType">
      <option value="motor">Motor</option>
      <option value="aracli_kurye">Araçlı Kurye</option>
      <option value="binek">Binek</option>
      <option value="vip">VIP</option>
      <option value="minibus">Minibüs</option>
      <option value="taksi">Taksi</option>
    </select>

    <button id="submitBtn" onclick="submitApplication()">Başvuruyu Gönder</button>

    <div id="msg" class="notice"></div>

    <div class="small">
      Onay sonrası <a href="./driver.html">driver.html</a> üzerinden giriş yapılır.
    </div>
  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzzwdIUkPheKBoJS3U13pvrFMi9VutO-M0gM-LRfDnUnrk6JwrBAevMKp9a4Ecy6Dcy/exec";

function cleanPhone(p){ return (p||"").replace(/\D/g,""); }

function showMsg(type,text){
  msg.style.display="block";
  msg.className="notice "+(type==="ok"?"ok":"bad");
  msg.textContent=text;
}

async function submitApplication(){
  const first_name = firstName.value.trim();
  const last_name  = lastName.value.trim();
  const phone      = cleanPhone(phone.value);
  const vehicle_type = vehicleType.value;

  if(!first_name || !last_name){
    showMsg("bad","Ad ve soyad zorunludur.");
    return;
  }
  if(phone.length < 10 || phone.length > 11){
    showMsg("bad","Telefon 10-11 hane olmalıdır.");
    return;
  }

  submitBtn.disabled = true;
  submitBtn.textContent = "Gönderiliyor...";

  try{
    const r = await fetch(API_URL,{
      method:"POST",
      body: JSON.stringify({
        action:"applyDriver",
        first_name,
        last_name,
        phone,
        vehicle_type
      })
    });
    const res = await r.json();

    if(res.ok){
      showMsg("ok","Başvurunuz alındı. Admin onayı bekleniyor.");
      firstName.value=""; lastName.value=""; phone.value="";
    }else{
      showMsg("bad",res.error||"Başvuru alınamadı.");
    }
  }catch(e){
    showMsg("bad","Sunucuya ulaşılamadı.");
  }finally{
    submitBtn.disabled = false;
    submitBtn.textContent = "Başvuruyu Gönder";
  }
}
</script>
</body>
</html>
